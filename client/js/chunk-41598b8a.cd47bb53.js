(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-41598b8a"],{"21ad":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-main",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list,border:""}},[a("el-table-column",{attrs:{prop:"date",label:"日期",formatter:e.dateFormat}}),a("el-table-column",{attrs:{prop:"name",label:"用户名"}}),a("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),a("el-table-column",{attrs:{prop:"identity",label:"身份"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[a("el-button",{attrs:{size:"mini"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,t.row)}}},[e._v("删除")])],1)]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{"current-page":e.paginations.currentPage,"page-sizes":e.paginations.pageSizes,"page-size":e.paginations.pageSize,layout:e.paginations.layout,total:e.paginations.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("userdialog",{attrs:{dialog:e.dialog,form:e.form},on:{updatePage:e._profile,close:e.handleClose}})],1)},i=[],s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{visible:e.dialog.show,title:e.dialog.title,width:"500px"},on:{"update:visible":function(t){return e.$set(e.dialog,"show",t)}}},[a("el-form",{ref:"dialog",attrs:{model:e.form,rules:e.dialog.add?e.rules1:e.rules2,"status-icon":""}},[a("el-form-item",{attrs:{label:"用户名",prop:"name","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入用户名"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[e._v(e._s(e.dialog.row))])],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email","label-width":e.formLabelWidth}},[a("el-input",{attrs:{placeholder:"请输入邮箱"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e.dialog.add?a("el-form-item",{attrs:{label:"密码",prop:"password","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1):e._e(),e.dialog.add?a("el-form-item",{attrs:{label:"确认密码",prop:"repassword","label-width":e.formLabelWidth}},[a("el-input",{attrs:{type:"password",placeholder:"请确认密码"},model:{value:e.form.repassword,callback:function(t){e.$set(e.form,"repassword",t)},expression:"form.repassword"}})],1):e._e(),a("el-form-item",{attrs:{label:"操作人",prop:"identity","label-width":e.formLabelWidth}},[a("el-select",{model:{value:e.form.identity,callback:function(t){e.$set(e.form,"identity",t)},expression:"form.identity"}},[a("el-option",{attrs:{label:"管理员",value:"管理员",placeholder:"请选择活动区域"}}),a("el-option",{attrs:{label:"普通用户",value:"普通用户"}})],1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.resetForm("dialog")}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addForm("dialog")}}},[e._v("确 定")])],1)],1)],1)},l=[],o=a("5723"),n={data(){var e=(e,t,a)=>{/^[A-Za-z0-9_\-\u4e00-\u9fa5]+$/.test(t)?a():a(new Error("用户名包含非法字符"))},t=(e,t,a)=>{t!=this.form.password?a(new Error("两次密码输入不正确")):a()};return{dialogFormVisible:!1,formLabelWidth:"120px",rules1:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:8,message:"长度在 3 到 5 个字符",trigger:"blur"},{validator:e,trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],repassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:t,trigger:"blur"}],identity:[{required:!0,message:"请选择操作人",trigger:"change"}]},rules2:{name:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:8,message:"长度在 3 到 5 个字符",trigger:"blur"},{validator:e,trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"邮箱格式不正确",trigger:"blur"}],identity:[{required:!0,message:"请选择操作人",trigger:"change"}]}}},methods:{resetForm(e){this.$refs[e].resetFields(),setTimeout(()=>{this.dialog.show=!1},0)},addForm(e){console.log(this.form),this.$refs[e].validate(t=>{console.log(t),t&&("add"===e?this._register():"edit"===e&&this._updateUser()),this.$emit("updatePage"),setTimeout(()=>{this.dialog.show=!1},0)})},async _register(){try{await Object(o["d"])(this.form),this.$message({message:"添加成功",type:"success"})}catch(e){this.$message({message:"错误",type:"error"})}},async _updateUser(){try{await Object(o["e"])(this.dialog.id,this.form),this.$message({message:"更新成功",type:"success"})}catch(e){this.$message({message:"错误",type:"error"})}},handleClose(){this.$emit("close"),this.$refs["dialog"].resetFields()}},props:{dialog:{type:Object},form:{type:Object}}},d=n,u=a("2877"),m=Object(u["a"])(d,s,l,!1,null,null,null),g=m.exports,p=a("7f08"),c={data(){return{list:[],filterList:[],dialog:{show:!1},form:{},paginations:{pageSize:5,total:0,pageSizes:[5,10,15,20],layout:"total, sizes, prev, pager, next",currentPage:1},filtetime:"",filtename:""}},components:{userdialog:g},methods:{handleollapse(e){this.isCollapse=e,this.asideWidth=e?65:200},async _profile(e,t){let a=await Object(o["g"])({page:e,pageSize:t});this.paginations.total=a.total,this.list=a.user},dateFormat(e){return Object(p["a"])(e)},async handleDelete(e,t){let a=t["_id"];await Object(o["a"])(a),this._profile(this.paginations.currentPage,this.paginations.pageSize)},handleEdit(e,t){this.dialog={show:!0,title:"用户编辑",add:!1,ref:"edit",id:t._id},this.form={name:t.name,email:t.email,identity:t.identity}},handleAdd(){this.form={},this.dialog={show:!0,title:"添加用户",add:!0,ref:"add"}},handleSizeChange(e){this.paginations.pageSize=e},handleCurrentChange(e){this.paginations.currentPage=e},handlefilter(){this.list=this.filterList.filter(e=>{let t=this.formateDate(e.date);return t>=this.formateDate(this.filtetime[0])&&t<=this.formateDate(this.filtetime[1])&&-1!=e.name.indexOf(this.filtename)||-1!=e.name.indexOf(this.filtename)})},formateDate(e){return new Date(e).getTime()},handleClose(){this.form={}}},created(){this._profile(this.paginations.currentPage,this.paginations.pageSize)}},f=c,h=(a("ed47"),Object(u["a"])(f,r,i,!1,null,"0bdcfa7e",null));t["default"]=h.exports},5723:function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return n})),a.d(t,"f",(function(){return d})),a.d(t,"b",(function(){return u}));var r=a("b775");const i=e=>Object(r["a"])("post","/users/register",e),s=e=>Object(r["a"])("post","/users/login",e),l=e=>Object(r["a"])("post","/users",e),o=e=>Object(r["a"])("delete",`/users/delete/${e}`),n=(e,t)=>Object(r["a"])("post",`/users/edit/${e}`,t),d=e=>Object(r["a"])("post","/upload",e),u=e=>Object(r["a"])("post","/upload/delete",e)},"7f08":function(e,t,a){"use strict";function r(e){var t=new Date(e.date),a=t.getFullYear(),r=t.getMonth()+1,i=t.getDate();return r<10&&(r="0"+r),i<10&&(i="0"+i),a+"-"+r+"-"+i}a.d(t,"a",(function(){return r}))},da40:function(e,t,a){},ed47:function(e,t,a){"use strict";var r=a("da40"),i=a.n(r);i.a}}]);
//# sourceMappingURL=chunk-41598b8a.cd47bb53.js.map